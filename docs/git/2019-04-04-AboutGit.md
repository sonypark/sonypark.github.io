2019년 4월 4일

# Git = DVCS(Distributed Version Control System)

---

## Git 을 사용하는 이유?

- Git은 **오픈소스**를 효과적으로 **관리**하기 위한 **목적**으로 만들어졌다. (ex. Linux)

- Git을 이용하면 **하나의 프로젝트**를 **여러 사람들**과 함께 **효과적으로 관리**할 수 있다.

- Git은 한 프로젝트를 **여러명이 동시에 병렬적으로 개발** 할 수 있게 해준다.
    - 따라서 프로젝트 **개발 속도**를 매우 빠르게 해준다.
    - 특히 **대규모 프로젝트**를 진행할 때 매우 유용하다.

### Git을 사용하지 않는다면 어떻게 프로젝트를 공유 할까?

- 소스 코드를 USB에 담아서 옮기거나 카톡, 이메일 등을 통해 다른 사람의 컴퓨터로 옮기는 방식으로 프로젝트를 공유 해야한다.
    
    - 그렇게 되면 A가 수정한 내역이 B라는 사람에게 전달되는데 시간이 오래 걸리고 동시에 작업 하기 힘들다

### SVN과 차이점

- **SVN**은 **중앙 서버**로부터 파일을 다운받아 사용하는 방식이다.

- Git은 중앙 서버의 개념이 없다.
    - 중앙 서버처럼 사용하는 컴퓨터가 있다고 할지라도, 그 서버가 망가졌을 때 다른 컴퓨터에서 소스 코드를 복구 할 수 있다는 특징이 있다.

### Git의 장점

#### 1. 분산적 개발

- 전체 개발 내역을 각 개발자의 **로컬 저장소에 복사** 할 수 있다.
- 또한 각각의 **수정 내용**을 합칠(**Merge**) 수 있다.

#### 2. 효율적 개발

- 변경 이력이 많아도 **변경된 내용만 저장**하여 효율적으로 메모리를 관리한다.
    
    - **모든 커밋**에 대해 **checksum(HASH)** 을 만들어 **데이터 무결성 보장**(SHA-1)
    - Git은 기본적으로 파일 시스템의 **스냅샷을 저장**한다.
    - 파일 및 스냅샵을 해시하여 버전 변경사항을 빠르게 체크한다.

#### 3. 비선형적 개발

- **브랜치**를 이용해 **트리 구조**로 작업을 할 수 있다.
- 여러개의 기능을 브랜치 별로 나눠서 개발할 수 있다.
- **충돌**이 발생했을 때 **효과적으로 해결** 할 수 있다.

#### 4. 변경 이력 보장

- 변경된 내용을 안전하게 저장하여 **언제든지 이전 커밋으로 돌아갈 수 있다.**

## Git 저장소를 만드는 방법

1. `git clone` github repository url
2. `git init` ( .git 파일을 만드는 역할)

    - `.git` = 로컬 저장소
    - `GitHub` = 리모트 저장소

- 우리가 작업하는 공간

  - 작업 디렉토리(`working dir` 또는 `working tree`)
  - 파일(소스코드) 편집

## Git

- `commit`
  - commit = 게임의 `save point`
  - 파일 및 폴더의 추가 변경 사항을 저장한다.
  - 커밋은 시간순으로 저장된다.
  - 한 번 커밋을 하면 `안전하게 저장`된다.
  - 어디에?  로컬저장소 == 내 컴퓨터의 `.git` 파일
  - `.git` 파일이 사라지는 경우
    - `.git` 파일을 삭제한 경우
    - 내 컴퓨터가 망가진 경우
  - 더 안전하게 저장하기위해 원격저장소에도 저장한다.
    - 원격저장소 = GitHub

![git_commit](./img/git-commit-img.png ':size=600%')

> 이미지 출처: https://backlog.com/git-tutorial/kr/intro/intro1_3.html 

##### `원격저장소(RR)`: 커밋 파일이 원격에 저장되는 공간(`GitHub`)

##### `로컬저장소(LR)`: 커밋 파일이 내 컴퓨터에 저장되는 공간(`.git 파일`)

##### `스테이지(STAGE)`: 커밋을 준비하는 공간

##### `작업 디렉토리(WD)`: 소스 작성 및 편집하는 공간

- `작업 디렉토리` --`add`--> `스테이지` --`commit`--> `로컬저장소`--`push`-->`원격저장소`

![img](./img/git-data-transport-commands.png)

- `git status`

  - **git 상태 확인**
  - 깨끗한 상태: WD - STAGE - LR  내 파일이 변경사항 없이 모두 같은 상태

- `add`

  - 파일을 **스테이지**에 올린다

- `commit`

  - 스테이지의 내용을 가지고 **커밋 객체**를 만든다

- `push`

  - 로컬저장소 파일을 **원격저장소**에 업로드 한다.
  
  - 로컬저장소와 원격저장소가 동일한 상태가 된다.

- `fetch`

  - (원격저장소에서 로컬저장소로)가져온다
  - 원격저장소에 있는 모든 파일을 가져온다. (`.git` 포함)

- `pull`
  - **fetch + merge**
  - 가져와 병합하기
  - 원격저장소의 파일을 가져와서 LR-STAGE-WD에 모두 저장하는 것

- `git commit --amend`

  - **마지막 커밋 메시지를 수정**할 때 사용

- 책 추천

  - **Pro GIt**: 반드시 읽어 볼 것! 도움 많이 된다.

## Tip

- **항상 브랜치에서 작업**한다!

- 커밋은 **의미있는 작업**을 했을 때 한다. - 의미없는 커밋은 하지 않는다.

- 브랜치로 이동 할 때는 `status`를 **깨끗한 상태**로 만들고 이동다.

  - `add, commit` 하고 다른 브랜치로 이동

  - 또는 `stash` 라는 임시저장소에 저장해놓고 이동
    - 당장 커밋 할 수 없는 상황일 때 `stash`에 저장해놓고 이동한다.

- `git`은 중복된 내용의 파일은 저장하지 않는다.

  - `.git`에 중복된 내용의 파일은 저장하지 않는다. - 그래서 빠르다

- 커밋은 항상 부모 커밋을 가진다.

  - 부모커밋  = HEAD

- `HEAD`는 지금 작업하는 로컬 브랜치를 가키린다
  
  - 현재 작업하는 브랜치의 가장 앞 부분(**마지막 커밋**)을 가리킨다.  

  - 커밋을 가리키게 할 수도 있다. (detached HEAD) -- 권장하지 않음
  
- **브랜치**는 **참조변수**이다.
  - 참조변수 그 이상 그 이하도 아니다.

- `checkout`은 `HEAD`를 옮긴다.

- `reset`은 `branch`와 `HEAD`를 모두 옮긴다.

- `rebase`는 현재 브랜치의 커밋들을 다른 브랜치로 복사해 옮긴다. (통째로 옮긴다.)
  
  - `rebase`는 새로운 커밋을 만들어낸다.
  - `rebase`는 항상 조심해서 써야한다.

- `merge`는 두 브랜치를 하나로 합친다.
  
  - 기존 커밋이 그대로 유지된 상태로 있다.

    - `rebase`처럼 새로운 커밋을 만들지 않는다.
    - `rebase`보다 안전하다.

- 터미널 추천
  - 맥북에서는 `zsh`
  - 서버에서는 `bash`

### 오늘 기억해야 할 두 가지!

- `커밋`은 다시 살릴 수 있다.
- `브랜치`는 `참조변수`이다.